<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Páka – houpačka (pes × slon)</title>
<style>
  body{font-family:system-ui,Arial,sans-serif;margin:20px;line-height:1.35}
  h2{margin:0 0 10px}
  .card{border:1px solid #ddd;border-radius:12px;padding:12px;margin-bottom:12px}
  svg{width:100%;height:260px;display:block}
  label{display:block;margin:10px 0 6px}
  input[type="range"]{width:100%}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .row > div{flex:1;min-width:220px}
</style>
</head>

<body>
<h2>Páka – houpací houpačka (pes × slon)</h2>

<div class="card">
  <svg viewBox="0 0 820 320" aria-label="Houpačka">
    <!-- zem -->
    <line x1="40" y1="280" x2="780" y2="280" stroke="black" opacity="0.18" stroke-width="4"/>
    <!-- podpěra -->
    <polygon points="410,280 360,280 410,170 460,280" fill="black" opacity="0.10"/>
    <circle cx="410" cy="170" r="10" fill="black" opacity="0.25"/>

    <!-- MĚŘÍTKO (NEOTÁČÍ SE) -->
    <g id="scale" font-size="12" fill="black" opacity="0.85"></g>

    <!-- HOUPAČKA (OTÁČÍ SE) -->
    <g id="boardGroup">
      <rect x="150" y="155" width="520" height="30" rx="14" fill="black" opacity="0.15"/>

      <!-- rysky -->
      <g opacity="0.12" stroke="black" stroke-width="2">
        <line x1="150" y1="155" x2="150" y2="185"></line>
        <line x1="215" y1="155" x2="215" y2="185"></line>
        <line x1="280" y1="155" x2="280" y2="185"></line>
        <line x1="345" y1="155" x2="345" y2="185"></line>
        <line x1="410" y1="155" x2="410" y2="185"></line>
        <line x1="475" y1="155" x2="475" y2="185"></line>
        <line x1="540" y1="155" x2="540" y2="185"></line>
        <line x1="605" y1="155" x2="605" y2="185"></line>
        <line x1="670" y1="155" x2="670" y2="185"></line>
      </g>

      <!-- pes -->
      <g id="dog">
        <circle r="16" fill="black" opacity="0.55"></circle>
        <circle cx="-10" cy="-12" r="6" fill="black" opacity="0.55"></circle>
        <circle cx="10" cy="-12" r="6" fill="black" opacity="0.55"></circle>
        <text y="30" text-anchor="middle" font-size="12" fill="black" opacity="0.75">pes</text>
      </g>

      <!-- slon -->
      <g id="elephant">
        <rect x="-18" y="-14" width="36" height="28" rx="8" fill="black" opacity="0.60"></rect>
        <rect x="18" y="-6" width="14" height="12" rx="6" fill="black" opacity="0.60"></rect>
        <circle cx="-10" cy="-16" r="6" fill="black" opacity="0.60"></circle>
        <circle cx="10" cy="-16" r="6" fill="black" opacity="0.60"></circle>
        <text y="30" text-anchor="middle" font-size="12" fill="black" opacity="0.75">slon</text>
      </g>
    </g>

    <text x="170" y="310" font-size="12" fill="black" opacity="0.55">levá strana (x &lt; 0)</text>
    <text x="560" y="310" font-size="12" fill="black" opacity="0.55">pravá strana (x &gt; 0)</text>
  </svg>
</div>

<div class="card">
  <div class="row">
    <div>
      <label>Hmotnost psa: <b><span id="mDogTxt">25</span></b> kg</label>
      <input id="massDog" type="range" min="1" max="6000" step="1" value="25">
    </div>
    <div>
      <label>Hmotnost slona: <b><span id="mElTxt">800</span></b> kg</label>
      <input id="massEl" type="range" min="1" max="6000" step="1" value="800">
    </div>
  </div>

  <div class="row">
    <div>
      <label>Délka prkna: <b><span id="lenTxt">4.0</span></b> m</label>
      <input id="len" type="range" min="1.5" max="10" step="0.1" value="4">
    </div>
  </div>
</div>

<script>
  const g = 9.81;

  const els = {
    dog: document.getElementById('dog'),
    elephant: document.getElementById('elephant'),
    scale: document.getElementById('scale'),
    board: document.getElementById('boardGroup'),
    massDog: document.getElementById('massDog'),
    massEl: document.getElementById('massEl'),
    len: document.getElementById('len'),
    mDogTxt: document.getElementById('mDogTxt'),
    mElTxt: document.getElementById('mElTxt'),
    lenTxt: document.getElementById('lenTxt'),
  };

  let xDog = -1.0;
  let xEl  =  1.0;

  function clamp(v, min, max){ return Math.min(max, Math.max(min, v)); }
  function mapX(xMeters, half){ return 410 + (xMeters / half) * 260; }

  function drawScale(half){
    // měřítko kreslíme jako NEOTOČENÉ, proto je mimo boardGroup
    els.scale.innerHTML = "";

    const step = 0.5;   // krok v metrech
    const y = 150;      // výška popisků nad prknem

    for(let i = -half; i <= half + 1e-9; i += step){
      const x = mapX(i, half);
      // malé značky (čárky)
      els.scale.innerHTML += `<line x1="${x}" y1="${y+2}" x2="${x}" y2="${y+10}" stroke="black" opacity="0.35" stroke-width="2"/>`;
      // čísla
      els.scale.innerHTML += `<text x="${x}" y="${y}" text-anchor="middle">${i.toFixed(1)}</text>`;
    }

    // zvýraznění středu
    els.scale.innerHTML += `<line x1="410" y1="${y+2}" x2="410" y2="${y+16}" stroke="black" opacity="0.55" stroke-width="3"/>`;
    els.scale.innerHTML += `<text x="410" y="${y-14}" text-anchor="middle">0.0</text>`;
  }

  function recalc(){
    const mDog = +els.massDog.value;
    const mEl  = +els.massEl.value;
    const L    = +els.len.value;
    const half = L/2;

    els.mDogTxt.textContent = mDog.toFixed(0);
    els.mElTxt.textContent  = mEl.toFixed(0);
    els.lenTxt.textContent  = L.toFixed(1);

    xDog = clamp(xDog, -half, half);
    xEl  = clamp(xEl,  -half, half);

    const Msum = (mDog*g*xDog) + (mEl*g*xEl);

    // auto-citlivost náklonu
    const maxMoment = (mDog + mEl) * g * half || 1;
    const tilt = clamp((Msum / maxMoment) * 14, -14, 14);

    // otáčení prkna
    els.board.setAttribute("transform", `rotate(${tilt} 410 170)`);

    // pozice zvířat (uvnitř otáčející se skupiny)
    els.dog.setAttribute("transform", `translate(${mapX(xDog,half)} 138)`);
    els.elephant.setAttribute("transform", `translate(${mapX(xEl,half)} 140)`);

    // měřítko (mimo otáčení)
    drawScale(half);
  }

  function enableDrag(el, setter){
    let dragging = false;

    el.addEventListener("mousedown", () => dragging = true);
    window.addEventListener("mouseup", () => dragging = false);

    window.addEventListener("mousemove", (e) => {
      if(!dragging) return;

      const rect = el.ownerSVGElement.getBoundingClientRect();
      const x = e.clientX - rect.left;

      const L = +els.len.value;
      const half = L/2;

      const meters = ((x - 410) / 260) * half;
      setter(clamp(meters, -half, half));
      recalc();
    });
  }

  enableDrag(els.dog, v => xDog = v);
  enableDrag(els.elephant, v => xEl = v);

  els.massDog.addEventListener("input", recalc);
  els.massEl.addEventListener("input", recalc);
  els.len.addEventListener("input", recalc);

  recalc();
</script>

</body>
</html>
